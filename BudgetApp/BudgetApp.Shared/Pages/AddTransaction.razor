@page "/add"
@page "/edit/{TransactionId:int}"

<PageTitle>@(IsEditing ? "Edit" : "Add") Transaction</PageTitle>

<div class="add-transaction">
    <PageHeader Title="@((IsEditing ? "Edit" : "Add") + " Transaction")" OnBack="GoBack" />

    <!-- Transaction Type Toggle -->
    <div class="type-toggle">
        <button class="type-btn @(IsExpense ? "active" : "")" @onclick="() => IsExpense = true">
            Expense
        </button>
        <button class="type-btn @(!IsExpense ? "active income" : "")" @onclick="() => IsExpense = false">
            Income
        </button>
    </div>

    <!-- Amount Input -->
    <div class="amount-section">
        <span class="currency-symbol">$</span>
        <input type="number" 
               class="amount-input" 
               placeholder="0.00" 
               step="0.01" 
               min="0"
               @bind="Amount" 
               @bind:event="oninput" />
    </div>

    <!-- Form Fields -->
    <div class="form-section">
        <!-- Description -->
        <div class="form-field">
            <label class="field-label">Description</label>
            <input type="text" 
                   class="field-input" 
                   placeholder="@(IsExpense ? "What was this for?" : "e.g., Bonus, Side gig, Gift")"
                   @bind="Description" />
        </div>

        <!-- Category (only for expenses) -->
        @if (IsExpense)
        {
            <div class="form-field">
                <label class="field-label">Category</label>
                <div class="category-grid">
                    @foreach (var category in Categories)
                    {
                        <button type="button"
                                class="category-chip @(SelectedCategoryId == category.Id ? "selected" : "")"
                                style="@(SelectedCategoryId == category.Id ? $"background-color: {category.Color}; border-color: {category.Color};" : "")"
                                @onclick="() => SelectedCategoryId = category.Id">
                            <span class="chip-icon">@category.Icon</span>
                            <span class="chip-name">@category.Name</span>
                        </button>
                    }
                </div>
            </div>
        }
        else
        {
            <div class="income-hint">
                <span class="hint-icon">ðŸ’¡</span>
                <span class="hint-text">Recording additional income beyond your monthly budget</span>
            </div>
        }

        <!-- Date -->
        <div class="form-field">
            <label class="field-label">Date</label>
            <input type="date" 
                   class="field-input" 
                   @bind="TransactionDate" />
        </div>
    </div>

    <!-- Save Button -->
    <div class="save-section">
        <button class="save-btn @(!IsValid ? "disabled" : "")" 
                @onclick="SaveTransaction" 
                disabled="@(!IsValid)">
            @(IsEditing ? "Update" : "Save") Transaction
        </button>
    </div>

    <div class="bottom-spacer"></div>
</div>
