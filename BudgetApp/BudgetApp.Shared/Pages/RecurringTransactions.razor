@page "/recurring"

<PageTitle>Recurring Transactions</PageTitle>

<div class="recurring-page">
    <PageHeader Title="Recurring" OnBack="GoBack" />

    <!-- Info Card -->
    <div class="info-card">
        <div class="info-icon">ðŸ”„</div>
        <div class="info-text">
            <span class="info-title">Automatic Transactions</span>
            <span class="info-desc">Set up bills and subscriptions to be added automatically each month.</span>
        </div>
    </div>

    <!-- Recurring List -->
    <div class="section">
        <div class="section-header">
            <span class="section-title">@(RecurringList.Count) recurring transactions</span>
        </div>

        @if (RecurringList.Any())
        {
            <div class="recurring-list">
                @foreach (var recurring in RecurringList)
                {
                    var category = Categories.FirstOrDefault(c => c.Id == recurring.CategoryId);
                    var isIncome = recurring.Type == TransactionType.Income;

                    <div class="recurring-item" @onclick="() => EditRecurring(recurring.Id)">
                        <div class="recurring-icon" style="background-color: @(category?.Color ?? "#6B7280")">
                            @(category?.Icon ?? "ðŸ’°")
                        </div>
                        <div class="recurring-info">
                            <span class="recurring-desc">@recurring.Description</span>
                            <span class="recurring-meta">
                                @GetFrequencyText(recurring.Frequency) Â· Next: @recurring.NextDueDate.ToString("MMM d")
                            </span>
                        </div>
                        <div class="recurring-right">
                            <span class="recurring-amount @(isIncome ? "income" : "expense")">
                                @(isIncome ? "+" : "-")@recurring.Amount.ToString("C2")
                            </span>
                            <span class="recurring-status @(recurring.IsActive ? "active" : "paused")">
                                @(recurring.IsActive ? "Active" : "Paused")
                            </span>
                        </div>
                    </div>
                }
            </div>
        }
        else
        {
            <EmptyState Icon="ðŸ”„" Message="No recurring transactions yet">
                <p class="empty-hint">Tap the + button to add your first recurring bill or subscription</p>
            </EmptyState>
        }
    </div>

    <div class="bottom-spacer"></div>

    <FloatingActionButton Label="Add Recurring" OnClick="AddRecurring" />
</div>
